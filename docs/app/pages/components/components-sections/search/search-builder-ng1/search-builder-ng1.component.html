<uxd-search-builder-wrapper></uxd-search-builder-wrapper>

<hr>

<p> The Search Builder provides a visual way for the user to easily build up complex search queries using predefined components.
  Click the button below to view all of the code used to produce the sample search builder modal above.</p>

<uxd-search-builder-code-wrapper [snippets]="snippets"></uxd-search-builder-code-wrapper>

<h4 id="search-builder-directive">Search Builder Directive</h4>

<p>The <code>search-builder</code> directive is designed to act as a container for <code>search-group</code> and <code>search-component</code>  directives. It provides a way to access the generated search query object and register the components that can be added.</p>

<uxd-snippet [content]="snippets.compiled.layoutHtml" language="html"></uxd-snippet>

<p>The following attributes are available to configure the behavior of the <code>search-builder</code>:</p>

<uxd-api-properties>
    <tr uxd-api-property name="search-query" type="object" binding="variable" required="true">
      This should be a binding to an object that will store the current search query generated by the <code>search-builder</code>.
      If this initially has a value, the <code>search-builder</code> will automatically update to show the correct groups
      and components with the values specified.
    </tr>
    <tr uxd-api-property name="components" type="array" binding="variable" required="true">
      This should provide an array containing information on the components that can be added to it. Each component should
      be given a unique name and a template url.
    </tr>
</uxd-api-properties>

<p>The following is an example of how the component array might look:</p>

<uxd-snippet [content]="snippets.compiled.componentArraySnippetJs" language="javascript"></uxd-snippet>

<h4 id="search-group-directive">Search Group Directive</h4>

<p>The <code>search-group</code> directive acts as a container for <code>search-component</code> directives. Each group should
  represent a specific operator (eg. and, or, not). It also provides a way to the user to add new fields to the groups.</p>

<uxd-snippet [content]="snippets.compiled.searchGroupSnippetHtml" language="html"></uxd-snippet>

<p>The following attributes can be used to configure the behavior of a <code>search-group</code>:</p>

<uxd-api-properties tableTitle="">
    <tr uxd-api-property name="group-id" type="string" binding="variable" required="true">
      	This should be a unique id given to each group to identify it in the generated search query.
    </tr>
    <tr uxd-api-property name="group-title" type="string" binding="variable" required="true">
      This will specify the text that will display at the top of each group.
    </tr>
    <tr uxd-api-property name="operator" type="string" binding="variable" required="true">
      This will specify the text that will display to the left of each group when more than one field has been added. The
      color beside the operator label will be set depending on the operator specified. Recommended options are
      <code>'and'</code>, <code>'or'</code> and <code>'not'</code>.
    </tr>
    <tr uxd-api-property name="button-text" type="string | string[]" binding="variable" required="true">
      This will specify the text that goes along side the add field button. If there should be multiple
      add field buttons this can be an array containing the text for each button.
    </tr>
    <tr uxd-api-property name="add-field" type="function | function[]" binding="variable" required="true">
      This will specify the function to be called when the add field button is clicked. This function should return an
      object that contains an <code>id</code> property giving the field a unique id, and a <code>component</code> property
      specifying the name of the component to be added. Additionally this function can return a <code>$q.defer().promise</code>
      if the type of field will not immediately be known. If a promise is returned a placeholder field will be displayed
      until the promise is either resolved or rejected.
      <br>
      If there should be multiple add field buttons then this can be an array containing the function for each button.
    </tr>
    <tr uxd-api-property name="remove-field" type="function" binding="variable">
      This will specify the function to be called when the remove field button is clicked. This function should accept
      one argument containing the ID of the component being removed. It should return a boolean, <code>true</code> indicating
      that the component should be removed and <code>false</code> indicating that the remove action should be cancelled.
      Additionally this function can return a <code>$q.defer().promise</code> to determine whether or not to remove the
      field at a later point. The promise can either be resolved with a <code>boolean</code> value or rejected, in which
      case the field will not be removed.
    </tr>
    <tr uxd-api-property name="read-only" type="boolean">
      Setting this to true will hide the add and remove buttons within the group.
    </tr>
</uxd-api-properties>

<h4 id="search-component-directive">Search Component Directive</h4>

<p>The <code>search-component</code> directive should be used to create a specific component that can be added to a <code>search-group</code>.
  Each <code>search-component</code> is responsible for setting the <code>model</code> property on itâ€™s scope. It is this
  value that will be displayed in the generated search query. For a <code>search-component</code> that has a single control,
  for example an <code>input</code>, simply setting the <code>ng-model</code> property will update the value automatically.</p>

<p>The following example will demonstrate the simplest form of <code>search-component</code>:</p>

<uxd-snippet [content]="snippets.compiled.textComponentHtml" language="html"></uxd-snippet>

<p>For a more complex <code>search-component</code>, such as a date range, it may be required to have a controller that will
  update the <code>model</code> when values are changed. To specify a controller simply add an <code>ng-controller</code>  attribute to the <code>search-component</code> tag.</p>

<p>The following example will demonstrate a more complex <code>search-component</code> that uses a controller to update the
  <code>model</code>:</p>

<ux-tabset [minimal]="false">
    <ux-tab heading="HTML">
        <uxd-snippet [content]="snippets.compiled.dateRangeComponentHtml" language="html"></uxd-snippet>
    </ux-tab>
    <ux-tab heading="JavaScript">
        <uxd-snippet [content]="snippets.compiled.dateRangeComponentJs" language="javascript"></uxd-snippet>
    </ux-tab>
</ux-tabset>

<h4 id="search-builder-modal">Search Builder Modal</h4>

<p>The Search Builder is designed to be used within a modal. A new modal layout was created specifically for the Search Builder.
  To utilize the Search Builder modal set the <code>windowClass</code> to <code>'search-builder-modal-window'</code> when
  specifying the modal options.</p>

<p>The modal template should be similar to the following code which has been set up to show a scrollbar when required.</p>

<uxd-snippet [content]="snippets.compiled.modalLayoutSnippetHtml" language="html"></uxd-snippet>

<blockquote>
  <p>Refer to the <a routerLink="/components/scrollbar" fragment="custom-scrollbar-ng1">Scrollbar</a> page for more information on how to configure the scrollbar.</p>
</blockquote>

<blockquote>
  <p>Refer to the <a routerLink="/components/modals" fragment="modal-ng1">Modal View</a> page for more information on how to configure the modal.</p>
</blockquote>

<h4 id="search-query-structure">Search Query Structure</h4>

<p>The structure of the generated search query is an object that contains child objects for each group that has components.
  The format is as follows:</p>

<ul>
  <li>group id
    <ul>
      <li>component id
        <ul>
          <li>component name</li>
          <li>component value</li>
        </ul>
      </li>
      <li>component id
        <ul>
          <li>component name</li>
          <li>component value</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>group id
    <ul>
      <li>component id
        <ul>
          <li>component name</li>
          <li>component value</li>
        </ul>
      </li>
      <li>component id
        <ul>
          <li>component name</li>
          <li>component value</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>An example of a search query is:</p>

<uxd-snippet [content]="snippets.compiled.searchQuerySnippetJs" language="javascript"></uxd-snippet>
