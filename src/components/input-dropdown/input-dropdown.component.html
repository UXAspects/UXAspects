<div class="ux-select-container">
    <button #button type="button" class="form-control"
            [uxMenuTriggerFor]="menu">
        <ng-template #defaultDisplayContent>{{selected ? (selected | json) : '-'}}</ng-template>
        <ng-container [ngTemplateOutlet]="displayContentRef || defaultDisplayContent"></ng-container>
    </button>
    <div class="ux-select-icons">
        <ux-icon name="close"
                 uxFocusIndicator
                 class="ux-select-icon ux-select-clear-icon"
                 *ngIf="allowNull && selected"
                 (click)="resetValue($event)"
                 (keydown.enter)="resetValue($event)"
                 tabindex="0">
        </ux-icon>
        <ux-icon name="chevron-down"
                 class="ux-select-icon ux-select-chevron-icon"
                 (click)="toggleMenu(); $event.stopPropagation()">
        </ux-icon>
    </div>
</div>

<ux-menu #menu menuClass="select-menu"
         (opened)="onMenuOpen()"
         (closed)="onMenuClose()"
         [attr.aria-expanded]="dropdownOpen">

    <div [style.max-height]="_maxHeight"
         [style.width.px]="button.offsetWidth">

        <div *ngIf="!hideFilter"
             class="filter-container">

            <input #filterInput
                    type="text"
                    [placeholder]="placeholder"
                    class="form-control"
                    [(ngModel)]="filter"
                    (input)="filterChange.emit(filter)"
                    (click)="$event.stopPropagation()"
                    [attr.aria-label]="ariaLabel || placeholder"
                    (focus)="inputFocusHandler()">

            <button type="button"
                    class="btn btn-flat filter-button"
                    (click)="resetFilter($event)"
                    [tabindex]="filter.length > 0 ? 0 : -1">
                <ux-icon [name]="filter.length === 0 ? 'search' : 'close'"></ux-icon>
            </button>
        </div>

        <ng-content></ng-content>

    </div>
</ux-menu>
