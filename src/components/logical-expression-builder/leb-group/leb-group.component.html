<tr
    class="leb-group"
    uxHoverActionContainer
    [focusIf]="_wasLastFocused$ | async"
    [style.padding-left.px]="indent || 8"
    uxFocusIndicator
    [programmaticFocusIndicator]="true">

    <td [style.max-width.px]="100">
        <ux-select
            uxFocusIndicatorOrigin
            [value]="selectedLogicalOperator"
            (valueChange)="handleSelectedOperatorChange($event)"
            [readonlyInput]="true"
            [options]="logicalOperators"
            [display]="'label'"
            [key]="'name'">
        </ux-select>
    </td>

    <td *ngIf="!_valid" class="m-l-md text-error">
        <ux-icon name="status-error-filled" class="m-r-xs"></ux-icon>
        {{ _errorMessage }}
    </td>

    <td class="logical-operator-delete">
        <button
            uxHoverAction
            (click)="deleteGroup()"
            type="button"
            class="btn btn-link btn-icon btn-lg button-secondary"
            [attr.aria-label]="('deleteLogicalOperatorAriaLabel' | l10n) || 'Delete logical operator'">
            <span class="ux-icon ux-icon-trash text-error" aria-hidden="true"></span>
        </button>
    </td>
</tr>

<ng-container *ngFor="let child of subExpression?.children; index as index">
    <ux-leb-condition
        *ngIf="child.type === 'condition'"
        (conditionChange)="handleGroupChange($event, index)"
        [condition]="child"
        [path]="setChildPath(index)"
        (conditionDeleted)="removeConditionAtIndex($event)"
        (conditionEmbedded)="embedConditionAtIndex($event)"
        [indent]="indent + additionalIndent">
    </ux-leb-condition>

    <ux-leb-group
        *ngIf="child.type === 'group'"
        [subExpression]="child"
        [path]="setChildPath(index)"
        (groupChange)="handleGroupChange($event, index)"
        [logicalOperatorName]="child.logicalOperator"
        [indent]="indent + additionalIndent">
    </ux-leb-group>
</ng-container>

<tr class="leb-group" *ngIf="_showAddBtn" [style.padding-left.px]="indent + additionalIndent">
    <td>
        <button
            [uxMenuTriggerFor]="addMenu"
            type="button"
            class="btn btn-icon button-primary"
            aria-label="Add">
            <span class="ux-icon ux-icon-add" aria-hidden="true"></span>
        </button>
    </td>
</tr>

<ux-menu #addMenu>
    <button type="button" uxMenuItem (click)="addCondition()" (keydown.enter)="addCondition()">
        <span class="dropdown-menu-text">{{ ('addConditionBtnText' | l10n) || 'Add condition' }}</span>
    </button>

    <button type="button" uxMenuItem (click)="addGroup()" (keydown.enter)="addGroup()">
        <span class="dropdown-menu-text">{{ ('addLogicalOperatorBtnText' | l10n) || 'Add logical operator'}} </span>
    </button>
</ux-menu>
