<tr
    *ngIf="editMode; else staticMode"
    class="leb-condition-row"
    [style.padding-left.px]="indent"
    cdkTrapFocus
    [cdkTrapFocusAutoCapture]="true"
    uxFocusIndicator
    [focusIf]="editMode"
    (keydown.escape)="cancelEdit()">

    <td class="field-selection">
        <ux-select
            [value]="_field"
            [input]="_field?.label || null"
            (valueChange)="handleFieldSelected($event)"
            [options]="fields"
            display="label"
            key="name">
        </ux-select>
    </td>

    <td class="operator-selection">
        <ux-select
            *ngIf="_field?.name"
            [value]="_operator"
            (valueChange)="handleOperatorSelected($event)"
            [input]="_operator?.label || null"
            [options]="operators"
            display="label"
            key="name">
        </ux-select>
    </td>

    <td class="value-input-container">
        <div #inputContainer></div>
    </td>

    <td>
        <button
            uxFocusIndicatorOrigin
            [disabled]="!(_field && _operator && _value && _valid)"
            (click)="confirmCondition()"
            type="button"
            class="btn btn-link btn-icon btn-lg button-primary"
            [attr.aria-label]="('confirmConditionAriaLabel' | l10n) || 'Confirm edit'">
            <span class="ux-icon ux-icon-checkmark" aria-hidden="true"></span>
        </button>

        <button
            uxFocusIndicatorOrigin
            (click)="cancelEdit()"
            type="button"
            class="btn btn-link btn-icon btn-lg button-secondary"
            [attr.aria-label]="('cancelConditionEditAriaLabel' | l10n) || 'Cancel editing'">
            <span class="ux-icon ux-icon-close" aria-hidden="true"></span>
        </button>
    </td>
</tr>

<ng-template #staticMode>
    <tr
        class="leb-condition-row"
        uxFocusIndicator
        [programmaticFocusIndicator]="true"
        [focusIf]="_wasLastFocused$ | async"
        uxTabbableList
        direction="horizontal"
        uxHoverActionContainer
        [style.padding-left.px]="indent">
        <td>
            <span class="leb-field-display">{{ _field.label }}</span> {{ _operator.label }} <span
            class="leb-value-display">{{ _value | displayValue:_field.fieldType:_field.data }}</span>
        </td>

        <td>
            <button
                uxFocusIndicatorOrigin
                uxTabbableListItem
                [disabled]="_editBlocked"
                uxHoverAction
                (click)="editCondition()"
                type="button"
                class="btn btn-link btn-icon btn-lg button-primary"
                [attr.aria-label]="('editConditionAriaLabel' | l10n) || 'Edit condition'">
                <span class="ux-icon ux-icon-edit" aria-hidden="true"></span>
            </button>

            <button
                uxFocusIndicatorOrigin
                uxTabbableListItem
                [disabled]="_editBlocked"
                uxHoverAction
                (click)="embedConditionInGroup()"
                type="button"
                class="btn btn-link btn-icon btn-lg button-secondary"
                [attr.aria-label]="('embedConditionAriaLabel' | l10n) || 'Embed condition'">
                <span class="ux-icon ux-icon-chart-organization" aria-hidden="true"></span>
            </button>

            <button
                uxFocusIndicatorOrigin
                uxTabbableListItem
                [disabled]="_editBlocked"
                uxHoverAction
                (click)="deleteCondition()"
                type="button"
                class="btn btn-link btn-icon btn-lg button-warning btn-delete-condition"
                [attr.aria-label]="('deleteConditionAriaLabel' | l10n) || 'Delete condition'">
                <span class="ux-icon ux-icon-trash" aria-hidden="true"></span>
            </button>
        </td>
    </tr>
</ng-template>
